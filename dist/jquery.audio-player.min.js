/*! Audio Player - v0.1.0 - 2016-05-07
* https://github.com/jonmbake/jquery-audio-player
* Copyright (c) 2016 Jon Bake; Licensed MIT */
!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],b):b(a.jQuery)}(this,function(a){function b(a){if("string"==typeof a.data&&(a.data={keys:a.data}),a.data&&a.data.keys&&"string"==typeof a.data.keys){var b=a.handler,c=a.data.keys.toLowerCase().split(" ");a.handler=function(a){if(this===a.target||!(jQuery.hotkeys.options.filterInputAcceptingElements&&jQuery.hotkeys.textInputTypes.test(a.target.nodeName)||jQuery.hotkeys.options.filterContentEditable&&jQuery(a.target).attr("contenteditable")||jQuery.hotkeys.options.filterTextInputs&&jQuery.inArray(a.target.type,jQuery.hotkeys.textAcceptingInputTypes)>-1)){var d="keypress"!==a.type&&jQuery.hotkeys.specialKeys[a.which],e=String.fromCharCode(a.which).toLowerCase(),f="",g={};jQuery.each(["alt","ctrl","shift"],function(b,c){a[c+"Key"]&&d!==c&&(f+=c+"+")}),a.metaKey&&!a.ctrlKey&&"meta"!==d&&(f+="meta+"),a.metaKey&&"meta"!==d&&f.indexOf("alt+ctrl+shift+")>-1&&(f=f.replace("alt+ctrl+shift+","hyper+")),d?g[f+d]=!0:(g[f+e]=!0,g[f+jQuery.hotkeys.shiftNums[e]]=!0,"shift+"===f&&(g[jQuery.hotkeys.shiftNums[e]]=!0));for(var h=0,i=c.length;i>h;h++)if(g[c[h]])return b.apply(this,arguments)}}}}var c={skipAmountSeconds:15,audioSrcUrl:"http://traffic.libsyn.com/timferriss/Tim_Ferriss_Show_-_Mike_Rowe.mp3",shortcuts:{playPause:"Alt+P",rewind:"Alt+B",fastforward:"Alt+F",speedUp:"Alt+U",slowDown:"Alt+D"}},d=function(b,d){this.$el=b,a.extend(this,c,d),this.audioLoaded=!1,this._initHtml(),this._initEvents(),this._initShortcuts()};a.extend(d.prototype,{pause:function(){this.audioLoaded&&(this.audioSrc.pause(),this.$playPause.removeClass("fa-pause").addClass("fa-play"))},play:function(){this.audioLoaded&&(this.audioSrc.play(),this.$playPause.removeClass("fa-play").addClass("fa-pause"))},togglePlay:function(){this.audioSrc.paused?this.play():this.pause()},rewind:function(){this.audioLoaded&&(this.audioSrc.currentTime>this.skipAmountSeconds?this.audioSrc.currentTime-=this.skipAmountSeconds:this.audioSrc.currentTime=0)},fastforward:function(){this.audioLoaded&&(this.audioSrc.duration-this.audioSrc.currentTime>this.skipAmountSeconds?this.audioSrc.currentTime+=this.skipAmountSeconds:this.audioSrc.currentTime=this.audioSrc.duration)},slowDown:function(){this.audioSrc.playbackRate.toFixed(1)>.5&&(this.audioSrc.playbackRate-=.1,this.$currSpeed.text(this.audioSrc.playbackRate.toFixed(1)))},speedUp:function(){this.audioSrc.playbackRate.toFixed(1)<2&&(this.audioSrc.playbackRate+=.1,this.$currSpeed.text(this.audioSrc.playbackRate.toFixed(1)))},loadAudioSource:function(a){this.audioSrc.src=a},_initHtml:function(){var a='<audio></audio>        <div class="player-wrapper">          <div class="player">            <div class="timeComponents">              <span class="timeline">                <span class="playhead"></span>              </span>              <span class="clock reading">00:00:00</span>            </div>            <div class="controls">              <span class="btnControls">              <a class="playPause btn fa-play"></a>              <a class="rewind btn fa-fast-backward"></a>              <a class="fastforward btn fa-fast-forward"></a>              <a class="slowDown btn fa-caret-square-o-down"></a>              <a class="speedUp btn fa-caret-square-o-up"></a>              </span>              <span class="reading">Speed: <span class="currSpeed">1.0</span>X</span>            </div>          </div>          <input type="file" name="audioFileInput" class="audioFileInput" accept="audio/*" />        </div>';this.$el.html(a),this.$audioSrc=this.$el.find("audio"),this.audioSrc=this.$audioSrc[0],this.$fileInput=this.$el.find('input[type="file"]'),this.$timeline=this.$el.find(".timeline"),this.$playhead=this.$el.find(".playhead"),this.$clock=this.$el.find(".clock"),this.$currSpeed=this.$el.find(".currSpeed"),this.$playPause=this.$el.find(".playPause"),this.$rewind=this.$el.find(".rewind"),this.$fastforward=this.$el.find(".fastforward"),this.$speedUp=this.$el.find(".speedUp"),this.$slowDown=this.$el.find(".slowDown"),this.audioSrcUrl&&(this.loadAudioSource(this.audioSrcUrl),this.$fileInput.hide())},_initEvents:function(){var a=this.audioSrc;this.$audioSrc.on("ended",this.pause.bind(this)),this.$audioSrc.on("timeupdate",this._syncTime.bind(this)),this.$audioSrc.on("loadeddata",function(){this.audioLoaded=!0,this.play()}.bind(this)),this.$playPause.on("click",this.togglePlay.bind(this)),this.$rewind.on("click",this.rewind.bind(this)),this.$fastforward.on("click",this.fastforward.bind(this)),this.$slowDown.on("click",this.slowDown.bind(this)),this.$speedUp.on("click",this.speedUp.bind(this)),this.$timeline.on("click",function(b){var c=(b.pageX-this.$timeline.offset().left)/this.$timeline.outerWidth();a.currentTime=a.duration*c,this._syncTime()}.bind(this));var b=this;this.$fileInput.on("change",function(){var a=this.files,c=URL.createObjectURL(a[0]);b.loadAudioSource(c)})},_initShortcuts:function(){var b=this.shortcuts;this.$el.find(".btnControls").children().each(function(){var c=a(this),d=c.attr("class").split(" ")[0],e=b[d];if(e){var f=a("<sub/>").text(e);a(this).append(f),a(document).bind("keydown",e,function(){c[0].click()})}})},_syncTime:function(){var a=60,b=3600,c=function(c){c=Math.round(c);var d=Math.floor(c/b),e=d*b,f=Math.floor((c-e)/60),g=f*a,h=c-e-g,i=10>d?"0"+d:d;return i+=":"+(10>f?"0"+f:f),i+=":"+(10>h?"0"+h:h)},d=(this.$timeline.outerWidth()-this.$playhead.outerWidth())*(this.audioSrc.currentTime/this.audioSrc.duration);this.$clock.text(c(this.audioSrc.currentTime)),this.$playhead.css("marginLeft",d+"px")}});var e=function(a){var b=a.data("audioPlayer");if(!b)throw new Error("Element is currently not an audio player.");return b},f={init:function(a){var b=new d(this,a);return this.data("audioPlayer",b),this},playPause:function(){return e(this).playPause()}};a.fn.audioPlayer=function(b){var c=arguments,d="string"==typeof b,e=this.map(function(){if(void 0===b||"object"==typeof b)return f.init.call(a(this),b);if(d&&f[b])return f[b].apply(a(this),Array.prototype.slice.call(c,1));throw new Error("Calling method that is not part of the API")});return d?0===b.indexOf("get")?e[0]:e.toArray():e},jQuery.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},textAcceptingInputTypes:["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"],textInputTypes:/textarea|input|select/i,options:{filterInputAcceptingElements:!1,filterTextInputs:!1,filterContentEditable:!1}},jQuery.each(["keydown","keyup","keypress"],function(){jQuery.event.special[this]={add:b}})});